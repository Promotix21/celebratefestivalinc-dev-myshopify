{% comment %}
  FILE LOCATION: snippets/recommendation-card.liquid
  
  Reusable snippet for displaying recommendation product cards in "Items You Might Like" section
  
  Usage:
  {% render 'recommendation-card', product: product_object %}
  
  Required parameter:
  - product: The product object to display
{% endcomment %}

{% if product %}
  <div class="recommendation-card">
    {% comment %} Plus Badge {% endcomment %}
    {% if product.metafields.custom.plus_eligible %}
      <span class="plus-badge-card">plus</span>
    {% endif %}
    
    {% comment %} Product Image with Link {% endcomment %}
    <a href="{{ product.url }}" class="card-image-link">
      {% if product.featured_image %}
        <img src="{{ product.featured_image | img_url: '200x200' }}" 
             alt="{{ product.title | escape }}"
             width="200"
             height="200"
             loading="lazy"
             class="card-image">
      {% else %}
        <div class="card-image-placeholder">
          <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#ccc">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <circle cx="8.5" cy="8.5" r="1.5"></circle>
            <polyline points="21 15 16 10 5 21"></polyline>
          </svg>
        </div>
      {% endif %}
    </a>
    
    {% comment %} Product Title with Link {% endcomment %}
    <h3 class="recommendation-title">
      <a href="{{ product.url }}">{{ product.title | truncate: 50 }}</a>
    </h3>
    
    {% comment %} Product Rating (if available) {% endcomment %}
    {% if product.metafields.reviews.rating %}
      <div class="card-rating">
        {% assign rating = product.metafields.reviews.rating | times: 1.0 %}
        {% assign rating_floor = rating | floor %}
        {% for i in (1..5) %}
          {% if i <= rating_floor %}
            <span class="star filled">★</span>
          {% else %}
            <span class="star empty">★</span>
          {% endif %}
        {% endfor %}
        <span class="rating-count">({{ product.metafields.reviews.count | default: 0 }})</span>
      </div>
    {% endif %}
    
    {% comment %} Product Price {% endcomment %}
    <p class="recommendation-price">
      {% if product.price_varies %}
        <span class="from-text">From</span>
      {% endif %}
      {% if product.compare_at_price > product.price %}
        <span class="price-compare">${{ product.compare_at_price | money_without_currency }}</span>
      {% endif %}
      <span class="price-current">${{ product.price | money_without_currency }}</span>
      <span class="unit">/Each</span>
    </p>
    
    {% comment %} Quick Add Actions {% endcomment %}
    <div class="quick-add-actions">
      <input type="number" 
             value="1" 
             min="1" 
             class="quick-qty"
             aria-label="Quantity">
      <button class="btn-quick-add" 
              data-product-id="{{ product.variants.first.id }}"
              {% unless product.available %}disabled{% endunless %}>
        {% if product.available %}
          Add to Cart
        {% else %}
          Sold Out
        {% endif %}
      </button>
    </div>
  </div>
{% endif %}
