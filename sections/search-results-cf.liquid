{% comment %}
  Search Results Page - Celebrate Festival Compact Design
  Uses same product card design as L2 for visual consistency
{% endcomment %}

{{ 'search-results.css' | asset_url | stylesheet_tag }}

<style>
/* ========================================
   CF SEARCH RESULTS - Matching L2 PLP Design
   ======================================== */

/* Color Variables */
.cf-plp {
  --deep-blue: #1a3a5c;
  --primary-blue: #2563eb;
  --medium-blue: #3b82f6;
  --light-blue: #60a5fa;
  --pale-blue: #dbeafe;
  --sky-blue: #e0f2fe;
  --deep-red: #991b1b;
  --primary-red: #dc2626;
  --bright-red: #ef4444;
  --coral: #ff6b6b;
  --text-dark: #0f172a;
  --text-medium: #475569;
  --text-light: #64748b;
  --text-muted: #94a3b8;
  --border-color: #e2e8f0;
  --bg-light: #f8fafc;
  --bg-white: #ffffff;
  --rating-gold: #f59e0b;
  --success-green: #10b981;
}

.cf-plp {
  font-family: 'Inter', sans-serif;
  background: var(--bg-white);
}

/* ========================================
   COMPACT HEADER ROW 1 - Breadcrumb (left) | Title (right)
   ======================================== */
.cf-plp__header-compact {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 40px;
  background: var(--bg-white);
  border-bottom: 1px solid var(--border-color);
  gap: 20px;
}

.cf-plp__breadcrumb-inline {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
}

.cf-plp__breadcrumb-inline a {
  color: var(--medium-blue);
  text-decoration: none;
}

.cf-plp__breadcrumb-inline a:hover {
  color: var(--coral);
}

.cf-plp__breadcrumb-sep {
  color: var(--text-muted);
}

.cf-plp__breadcrumb-current {
  color: var(--text-muted);
}

.cf-plp__title-compact {
  font-family: 'Montserrat', sans-serif;
  font-size: 20px;
  font-weight: 700;
  color: var(--deep-blue);
  margin: 0;
  white-space: nowrap;
}

/* ========================================
   MAIN CONTAINER - Sidebar + Products
   ======================================== */
.cf-plp__container {
  display: flex;
  gap: 24px;
}

/* ========================================
   FILTERS SIDEBAR
   ======================================== */
.cf-plp__sidebar {
  width: 260px;
  min-width: 260px;
  flex-shrink: 0;
  padding: 24px;
  border-right: 1px solid var(--border-color);
  background: var(--bg-light);
}

.cf-plp__filters-title {
  font-family: 'Montserrat', sans-serif;
  font-size: 16px;
  font-weight: 700;
  color: var(--deep-blue);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.cf-plp__filters-title::before {
  content: '';
  width: 3px;
  height: 18px;
  background: var(--coral);
  border-radius: 2px;
}

.cf-plp__filter-group {
  margin-bottom: 24px;
  padding-bottom: 20px;
  border-bottom: 1px solid var(--border-color);
}

.cf-plp__filter-group:last-child {
  border-bottom: none;
}

.cf-plp__filter-title {
  font-size: 13px;
  font-weight: 700;
  color: var(--deep-blue);
  margin-bottom: 14px;
}

.cf-plp__filter-options {
  list-style: none;
  padding: 0;
  margin: 0;
}

.cf-plp__filter-options li {
  margin-bottom: 10px;
}

.cf-plp__filter-option {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 13px;
  color: var(--text-medium);
  cursor: pointer;
}

.cf-plp__filter-option:hover {
  color: var(--deep-blue);
}

.cf-plp__filter-option input[type="checkbox"] {
  width: 16px;
  height: 16px;
  accent-color: var(--medium-blue);
  cursor: pointer;
}

/* ========================================
   PRODUCTS AREA
   ======================================== */
.cf-plp__products {
  flex: 1;
  padding: 24px 30px;
  min-width: 0;
}

/* ========================================
   TOOLBAR
   ======================================== */
.cf-plp__toolbar-compact {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 24px;
  background: var(--bg-light);
  border-bottom: 1px solid var(--border-color);
  gap: 16px;
  flex-wrap: wrap;
}

.cf-plp__toolbar-compact__left {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  flex: 1;
  min-width: 0;
}

.cf-plp__toolbar-compact__right {
  display: flex;
  align-items: center;
  gap: 16px;
}

.cf-plp__results-count {
  font-size: 13px;
  color: var(--text-medium);
}

.cf-plp__active-filters-inline {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.cf-plp__active-filters-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-medium);
  white-space: nowrap;
}

.cf-plp__active-filters-list {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.cf-plp__filter-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  background: rgba(255, 107, 107, 0.1);
  border: 1px solid rgba(255, 107, 107, 0.3);
  border-radius: 20px;
  font-size: 11px;
  color: var(--coral);
}

.cf-plp__filter-chip-remove {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--coral);
  color: white;
  border: none;
  cursor: pointer;
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cf-plp__clear-all {
  padding: 5px 10px;
  font-size: 11px;
  font-weight: 600;
  color: var(--medium-blue);
  background: none;
  border: 1px solid var(--medium-blue);
  border-radius: 4px;
  cursor: pointer;
  white-space: nowrap;
}

.cf-plp__clear-all:hover {
  background: var(--medium-blue);
  color: white;
}

/* View Toggle */
.cf-plp__view-toggle {
  display: flex;
  gap: 0;
}

.cf-plp__view-btn {
  padding: 8px 14px;
  border: 1px solid var(--border-color);
  background: var(--bg-white);
  font-size: 12px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  color: var(--text-medium);
}

.cf-plp__view-btn:first-child {
  border-radius: 6px 0 0 6px;
}

.cf-plp__view-btn:last-child {
  border-radius: 0 6px 6px 0;
  border-left: none;
}

.cf-plp__view-btn.active {
  background: var(--deep-blue);
  color: white;
  border-color: var(--deep-blue);
}

/* Sort */
.cf-plp__sort {
  display: flex;
  align-items: center;
  gap: 8px;
}

.cf-plp__sort label {
  font-size: 12px;
  color: var(--text-medium);
}

.cf-plp__sort select {
  padding: 8px 30px 8px 12px;
  border: 1px solid var(--border-color);
  border-radius: 6px;
  font-size: 12px;
  background: var(--bg-white);
  cursor: pointer;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2364748b' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10l-5 5z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 10px center;
}

/* ========================================
   PRODUCT GRID
   ======================================== */
.cf-plp__grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  margin-top: 20px;
}

/* ========================================
   PRODUCT CARD - Matching L2 Design
   ======================================== */
.cf-plp__card {
  background: var(--bg-white);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 20px;
  position: relative;
  transition: all 0.3s ease;
}

.cf-plp__card:hover {
  border-color: var(--primary-blue);
  box-shadow: 0 12px 40px rgba(37, 99, 235, 0.12);
  transform: translateY(-4px);
}

.cf-plp__card-badge {
  position: absolute;
  top: 16px;
  left: 16px;
  background: var(--deep-blue);
  color: white;
  font-size: 10px;
  padding: 4px 10px;
  font-weight: 700;
  border-radius: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  z-index: 2;
}

.cf-plp__card-image-wrap {
  display: block;
  width: 100%;
  height: 160px;
  margin-bottom: 16px;
  background: #ffffff;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  overflow: hidden;
  position: relative;
}

.cf-plp__card-image {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: contain;
  transition: filter 0.3s ease, transform 0.3s ease;
}

.cf-plp__card:hover .cf-plp__card-image {
  filter: brightness(1.08);
  transform: scale(1.02);
}

/* Shine Sweep Effect */
.cf-plp__card-image-wrap::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(255, 255, 255, 0) 20%,
    rgba(255, 255, 255, 0.6) 50%,
    rgba(255, 255, 255, 0) 80%,
    transparent 100%
  );
  transform: skewX(-25deg);
  z-index: 1;
  transition: left 0.7s ease;
  pointer-events: none;
}

.cf-plp__card:hover .cf-plp__card-image-wrap::before {
  left: 150%;
}

/* Variants Badge */
.cf-plp__variants-badge {
  position: absolute;
  top: 8px;
  right: 8px;
  background: var(--deep-blue);
  color: white;
  border-radius: 20px;
  padding: 5px 10px;
  font-size: 10px;
  font-weight: 600;
  cursor: pointer;
  z-index: 5;
  transition: all 0.3s ease;
  white-space: nowrap;
}

.cf-plp__variants-text {
  display: block;
}

.cf-plp__variants-tooltip {
  display: none;
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  background: var(--deep-blue);
  color: white;
  padding: 10px 14px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 500;
  line-height: 1.4;
  min-width: 180px;
  max-width: 280px;
  white-space: normal;
  text-align: left;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  z-index: 10;
}

.cf-plp__variants-tooltip::before {
  content: '';
  position: absolute;
  top: -6px;
  right: 12px;
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-bottom: 6px solid var(--deep-blue);
}

.cf-plp__variants-badge:hover {
  background: var(--primary-blue);
}

.cf-plp__variants-badge:hover .cf-plp__variants-tooltip {
  display: block;
}

.cf-plp__card-category {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: var(--text-muted);
  margin-bottom: 8px;
  background: var(--sky-blue);
  padding: 4px 10px;
  border-radius: 20px;
}

.cf-plp__card-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--deep-blue);
  text-decoration: none;
  line-height: 1.4;
  display: block;
  margin-bottom: 8px;
  transition: color 0.2s ease;
}

.cf-plp__card-title:hover {
  color: var(--primary-blue);
}

.cf-plp__card-sku {
  font-size: 11px;
  color: var(--text-muted);
  margin-bottom: 6px;
}

/* Price Box */
.cf-plp__price-box {
  background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
  border: 1px solid #e2e8f0;
  padding: 8px 10px;
  margin-bottom: 8px;
  text-align: center;
  border-radius: 6px;
}

.cf-plp__price-label {
  font-size: 10px;
  color: var(--primary-blue);
  font-weight: 700;
  margin-bottom: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.cf-plp__price-main {
  font-family: 'Montserrat', sans-serif;
  font-size: 22px;
  font-weight: 800;
  color: var(--primary-red);
}

.cf-plp__price-unit {
  font-size: 12px;
  color: var(--text-medium);
  font-weight: 400;
}

.cf-plp__price-regular {
  font-size: 12px;
  color: var(--text-muted);
  text-decoration: line-through;
  margin-top: 4px;
}

/* Login Prompt */
.cf-plp__login-prompt {
  display: inline-block;
  margin-top: 8px;
  padding: 6px 12px;
  background: linear-gradient(135deg, rgba(37, 99, 235, 0.1) 0%, rgba(26, 58, 92, 0.1) 100%);
  border: 1px dashed var(--primary-blue);
  border-radius: 6px;
  color: var(--primary-blue);
  font-size: 11px;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.2s ease;
}

.cf-plp__login-prompt:hover {
  background: var(--primary-blue);
  color: white;
  border-style: solid;
}

/* Call for More Details Prompt - MAP Compliance for non-CF vendors */
.cf-plp__call-prompt {
  display: inline-block;
  margin-top: 8px;
  padding: 6px 12px;
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
  border: 1px solid #e2e8f0;
  border-radius: 6px;
  color: #1a365d;
  font-size: 11px;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.2s ease;
}

.cf-plp__call-prompt:hover {
  background: linear-gradient(135deg, #1a365d 0%, #2d5a87 100%);
  color: #ffffff;
  border-color: #1a365d;
}

/* Shipping Badge */
.cf-plp__shipping {
  display: inline-block;
  font-size: 10px;
  padding: 5px 12px;
  font-weight: 700;
  border-radius: 20px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 10px;
}

.cf-plp__shipping--free {
  background: linear-gradient(135deg, var(--success-green) 0%, #059669 100%);
  color: white;
}

.cf-plp__shipping--quick {
  background: linear-gradient(135deg, var(--primary-blue) 0%, var(--deep-blue) 100%);
  color: white;
}

.cf-plp__shipping--regular {
  background: var(--bg-light);
  color: var(--text-medium);
}

/* Add to Cart Row */
.cf-plp__cart-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 14px;
}

.cf-plp__qty-input {
  width: 50px;
  height: 38px;
  border: 2px solid #e2e8f0;
  border-radius: 6px;
  text-align: center;
  font-size: 14px;
  font-weight: 600;
  color: #0f172a;
}

.cf-plp__qty-input:focus {
  outline: none;
  border-color: #2d5a87;
}

.cf-plp__add-btn {
  flex: 1;
  height: 38px;
  background: linear-gradient(135deg, #2d5a87 0%, #1a365d 100%);
  color: #ffffff;
  border: none;
  font-size: 12px;
  font-weight: 700;
  cursor: pointer;
  border-radius: 6px;
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.cf-plp__add-btn:hover {
  background: linear-gradient(135deg, #3d6a9f 0%, #2d5a87 100%);
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(45, 90, 135, 0.3);
}

/* ========================================
   PAGINATION
   ======================================== */
.cf-plp__pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  padding: 30px 20px;
}

.cf-plp__page-btn {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  background: var(--bg-white);
  font-size: 13px;
  cursor: pointer;
  color: var(--text-medium);
  transition: all 0.2s ease;
  text-decoration: none;
}

.cf-plp__page-btn:hover:not(:disabled) {
  border-color: var(--medium-blue);
  color: var(--medium-blue);
}

.cf-plp__page-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.cf-plp__page-num {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  background: var(--bg-white);
  font-size: 13px;
  cursor: pointer;
  color: var(--text-medium);
  text-decoration: none;
}

.cf-plp__page-num.active {
  background: var(--deep-blue);
  color: white;
  border-color: var(--deep-blue);
}

/* ========================================
   NO RESULTS
   ======================================== */
.cf-plp__no-results {
  text-align: center;
  padding: 60px 20px;
}

.cf-plp__no-results-icon {
  font-size: 64px;
  color: var(--text-muted);
  margin-bottom: 20px;
}

.cf-plp__no-results h2 {
  font-family: 'Montserrat', sans-serif;
  font-size: 24px;
  color: var(--deep-blue);
  margin-bottom: 10px;
}

.cf-plp__no-results p {
  color: var(--text-medium);
}

/* ============================================
   COMPACT MODE - 5 Columns (Scaled Down)
   ============================================ */
.cf-plp--compact .cf-plp__container {
  gap: 20px;
}

.cf-plp--compact .cf-plp__sidebar {
  width: 220px;
  min-width: 220px;
  padding: 16px;
}

.cf-plp--compact .cf-plp__filters-title {
  font-size: 14px;
  margin-bottom: 12px;
}

.cf-plp--compact .cf-plp__filter-group {
  margin-bottom: 12px;
  padding-bottom: 10px;
}

.cf-plp--compact .cf-plp__filter-title {
  font-size: 11px;
  padding: 0;
  margin: 0 0 6px;
}

.cf-plp--compact .cf-plp__filter-options li {
  margin-bottom: 4px;
}

.cf-plp--compact .cf-plp__filter-option {
  font-size: 11px;
  padding: 2px 0;
  gap: 6px;
}

.cf-plp--compact .cf-plp__filter-option input[type="checkbox"] {
  width: 14px;
  height: 14px;
}

.cf-plp--compact .cf-plp__products {
  padding: 16px 20px;
}

.cf-plp--compact .cf-plp__grid {
  grid-template-columns: repeat(5, 1fr);
  gap: 14px;
}

.cf-plp--compact .cf-plp__card {
  padding: 12px;
  border-radius: 10px;
}

.cf-plp--compact .cf-plp__card-badge {
  top: 10px;
  left: 10px;
  font-size: 9px;
  padding: 3px 8px;
}

.cf-plp--compact .cf-plp__card-image-wrap {
  height: 120px;
  margin-bottom: 10px;
  border-radius: 6px;
}

.cf-plp--compact .cf-plp__card-category {
  font-size: 9px;
  padding: 3px 8px;
  margin-bottom: 6px;
}

.cf-plp--compact .cf-plp__card-title {
  font-size: 11px;
  margin-bottom: 6px;
  line-height: 1.35;
  min-height: calc(11px * 1.35 * 2);
  -webkit-line-clamp: 2;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.cf-plp--compact .cf-plp__card-sku {
  font-size: 9px;
  margin-bottom: 4px;
}

.cf-plp--compact .cf-plp__price-box {
  padding: 8px 6px;
  border-radius: 6px;
}

.cf-plp--compact .cf-plp__price-label {
  font-size: 9px;
  margin-bottom: 2px;
}

.cf-plp--compact .cf-plp__price-main {
  font-size: 15px;
}

.cf-plp--compact .cf-plp__price-regular {
  font-size: 10px;
}

.cf-plp--compact .cf-plp__shipping {
  font-size: 9px;
  padding: 4px 8px;
  margin-top: 6px;
}

.cf-plp--compact .cf-plp__cart-row {
  margin-top: 8px;
  gap: 6px;
}

.cf-plp--compact .cf-plp__qty-input {
  width: 50px;
  padding: 6px 4px;
  font-size: 11px;
  height: auto;
}

.cf-plp--compact .cf-plp__add-btn {
  padding: 8px 10px;
  font-size: 10px;
  height: auto;
}

.cf-plp--compact .cf-plp__variants-badge {
  padding: 3px 8px;
  font-size: 9px;
}

/* Compact toolbar */
.cf-plp--compact .cf-plp__toolbar-compact {
  padding: 10px 20px;
}

.cf-plp--compact .cf-plp__toolbar-compact__left {
  flex: 1;
  min-width: 0;
}

.cf-plp--compact .cf-plp__active-filters-inline {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.cf-plp--compact .cf-plp__active-filters-label {
  font-size: 11px;
  white-space: nowrap;
}

.cf-plp--compact .cf-plp__active-filters-list {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  flex: 1;
  min-width: 0;
}

.cf-plp--compact .cf-plp__clear-all {
  padding: 4px 8px;
  font-size: 10px;
  white-space: nowrap;
  flex-shrink: 0;
}

.cf-plp--compact .cf-plp__filter-chip {
  padding: 3px 8px;
  font-size: 10px;
  gap: 4px;
  border-radius: 12px;
}

.cf-plp--compact .cf-plp__filter-chip-remove {
  width: 12px;
  height: 12px;
  font-size: 8px;
}

.cf-plp--compact .cf-plp__results-count {
  font-size: 12px;
}

.cf-plp--compact .cf-plp__sort label {
  display: none;
}

.cf-plp--compact .cf-plp__sort select {
  font-size: 11px;
  padding: 6px 10px;
}

/* View toggle - icons only in compact mode */
.cf-plp--compact .cf-plp__view-btn {
  width: 32px;
  height: 32px;
  padding: 0;
  justify-content: center;
  font-size: 0;
  gap: 0;
}

.cf-plp--compact .cf-plp__view-btn svg {
  width: 14px;
  height: 14px;
}

/* Compact pagination */
.cf-plp--compact .cf-plp__pagination {
  padding: 16px;
  gap: 6px;
}

.cf-plp--compact .cf-plp__page-btn,
.cf-plp--compact .cf-plp__page-num {
  width: 32px;
  height: 32px;
  font-size: 12px;
}

/* Mobile Filter Button */
.cf-plp__mobile-filter-btn {
  display: none;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  background: var(--deep-blue);
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
}

.cf-plp__mobile-filter-btn svg {
  width: 14px;
  height: 14px;
}

/* Mobile Filter Drawer */
.cf-plp__mobile-filter-drawer {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9999;
}

.cf-plp__mobile-filter-drawer.active {
  display: block;
}

.cf-plp__mobile-filter-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
}

.cf-plp__mobile-filter-panel {
  position: absolute;
  top: 0;
  right: 0;
  width: 280px;
  max-width: 85%;
  height: 100%;
  background: white;
  overflow-y: auto;
  transform: translateX(100%);
  transition: transform 0.3s ease;
}

.cf-plp__mobile-filter-drawer.active .cf-plp__mobile-filter-panel {
  transform: translateX(0);
}

.cf-plp__mobile-filter-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px;
  border-bottom: 1px solid var(--border-color);
  background: var(--deep-blue);
  color: white;
}

.cf-plp__mobile-filter-header h3 {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
}

.cf-plp__mobile-filter-close {
  background: none;
  border: none;
  color: white;
  font-size: 20px;
  cursor: pointer;
  padding: 0;
  line-height: 1;
}

.cf-plp__mobile-filter-content {
  padding: 12px 16px;
}

.cf-plp__mobile-filter-apply {
  position: sticky;
  bottom: 0;
  padding: 12px 16px;
  background: white;
  border-top: 1px solid var(--border-color);
}

.cf-plp__mobile-filter-apply button {
  width: 100%;
  padding: 12px;
  background: var(--primary-red);
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
}

/* Responsive adjustments */
@media (max-width: 1400px) {
  .cf-plp--compact .cf-plp__grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 1100px) {
  .cf-plp--compact .cf-plp__grid {
    grid-template-columns: repeat(3, 1fr);
  }
  .cf-plp--compact .cf-plp__sidebar {
    display: none;
  }
  .cf-plp--compact .cf-plp__mobile-filter-btn {
    display: inline-flex;
  }
}

@media (max-width: 768px) {
  .cf-plp--compact .cf-plp__grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
  }
  .cf-plp--compact .cf-plp__card {
    padding: 10px;
  }
  .cf-plp--compact .cf-plp__card-image-wrap {
    height: 100px;
  }
  .cf-plp__header-compact {
    padding: 10px 15px;
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  .cf-plp__title-compact {
    font-size: 16px;
  }
}
</style>

<div class="cf-plp{% if section.settings.compact_mode %} cf-plp--compact{% endif %}" data-section-id="{{ section.id }}">

  {% comment %} Compact Header Row 1: Breadcrumb (left) | Title (right) {% endcomment %}
  <header class="cf-plp__header-compact">
    <nav class="cf-plp__breadcrumb-inline" aria-label="Breadcrumb">
      <a href="/">Home</a>
      <span class="cf-plp__breadcrumb-sep">‚Ä∫</span>
      <span class="cf-plp__breadcrumb-current">Search Results</span>
    </nav>
    <h1 class="cf-plp__title-compact">
      {% if search.performed %}
        {% if search.results_count > 0 %}
          Results for "{{ search.terms }}"
        {% else %}
          No results for "{{ search.terms }}"
        {% endif %}
      {% else %}
        Search Products
      {% endif %}
    </h1>
  </header>

  {% if search.performed %}
    {% paginate search.results by section.settings.products_per_page %}

    {% comment %} Main Container {% endcomment %}
    <div class="cf-plp__container">

      {% comment %} Filters Sidebar {% endcomment %}
      <aside class="cf-plp__sidebar">
        <h2 class="cf-plp__filters-title">Filters</h2>

        {% comment %} Brand Filter {% endcomment %}
        <div class="cf-plp__filter-group">
          <h3 class="cf-plp__filter-title">Brand</h3>
          <ul class="cf-plp__filter-options">
            {% assign vendors = search.results | map: 'vendor' | uniq | sort %}
            {% for vendor in vendors limit: 10 %}
              {% if vendor != blank %}
                <li>
                  <label class="cf-plp__filter-option">
                    <input type="checkbox" name="vendor" value="{{ vendor | handleize }}">
                    {{ vendor }}
                  </label>
                </li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>

        {% comment %} Product Type Filter {% endcomment %}
        <div class="cf-plp__filter-group">
          <h3 class="cf-plp__filter-title">Product Type</h3>
          <ul class="cf-plp__filter-options">
            {% assign product_types = search.results | map: 'type' | uniq | sort %}
            {% for type in product_types limit: 10 %}
              {% if type != blank %}
                <li>
                  <label class="cf-plp__filter-option">
                    <input type="checkbox" name="product-type" value="{{ type | handleize }}">
                    {{ type }}
                  </label>
                </li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>

        {% comment %} Price Range Filter {% endcomment %}
        <div class="cf-plp__filter-group">
          <h3 class="cf-plp__filter-title">Price Range</h3>
          <ul class="cf-plp__filter-options">
            <li>
              <label class="cf-plp__filter-option">
                <input type="checkbox" name="price" value="0-500">
                Under $500
              </label>
            </li>
            <li>
              <label class="cf-plp__filter-option">
                <input type="checkbox" name="price" value="500-1000">
                $500 - $1,000
              </label>
            </li>
            <li>
              <label class="cf-plp__filter-option">
                <input type="checkbox" name="price" value="1000-2500">
                $1,000 - $2,500
              </label>
            </li>
            <li>
              <label class="cf-plp__filter-option">
                <input type="checkbox" name="price" value="2500+">
                $2,500+
              </label>
            </li>
          </ul>
        </div>

        {% comment %} Availability Filter {% endcomment %}
        <div class="cf-plp__filter-group">
          <h3 class="cf-plp__filter-title">Availability</h3>
          <ul class="cf-plp__filter-options">
            <li>
              <label class="cf-plp__filter-option">
                <input type="checkbox" name="availability" value="in-stock">
                In Stock
              </label>
            </li>
          </ul>
        </div>
      </aside>

      {% comment %} Products Area {% endcomment %}
      <main class="cf-plp__products">

        {% comment %} Compact Toolbar {% endcomment %}
        <div class="cf-plp__toolbar-compact">
          <div class="cf-plp__toolbar-compact__left">
            <div class="cf-plp__active-filters-inline" id="active-filters" style="display: none;">
              <span class="cf-plp__active-filters-label">Active Filters:</span>
              <div class="cf-plp__active-filters-list" id="active-filters-list"></div>
              <button type="button" class="cf-plp__clear-all" id="clear-all-filters">Clear All</button>
            </div>
            <div class="cf-plp__results-count">
              <strong id="filtered-count">{{ search.results_count }}</strong> products found
            </div>
          </div>

          <div class="cf-plp__toolbar-compact__right">
            <button type="button" class="cf-plp__mobile-filter-btn" id="mobile-filter-btn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="4" y1="6" x2="20" y2="6"></line>
                <line x1="8" y1="12" x2="16" y2="12"></line>
                <line x1="11" y1="18" x2="13" y2="18"></line>
              </svg>
              Filters
            </button>
            <div class="cf-plp__view-toggle">
              <button class="cf-plp__view-btn active" data-view="grid">
                <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                  <rect x="0" y="0" width="7" height="7" rx="1"/>
                  <rect x="9" y="0" width="7" height="7" rx="1"/>
                  <rect x="0" y="9" width="7" height="7" rx="1"/>
                  <rect x="9" y="9" width="7" height="7" rx="1"/>
                </svg>
                Grid
              </button>
              <button class="cf-plp__view-btn" data-view="list">
                <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                  <rect x="0" y="1" width="16" height="3" rx="1"/>
                  <rect x="0" y="6" width="16" height="3" rx="1"/>
                  <rect x="0" y="11" width="16" height="3" rx="1"/>
                </svg>
                List
              </button>
            </div>

            <div class="cf-plp__sort">
              <label for="search-sort">Sort by</label>
              <select id="search-sort" onchange="handleSearchSort(this.value)">
                <option value="relevance">Most Relevant</option>
                <option value="price-ascending">Price: Low to High</option>
                <option value="price-descending">Price: High to Low</option>
                <option value="title-ascending">Name: A-Z</option>
              </select>
            </div>
          </div>
        </div>

        {% comment %} Product Grid - Using L2 inline card design {% endcomment %}
        {% if search.results_count > 0 %}
          <div class="cf-plp__grid" id="product-grid">
            {% for item in search.results %}
              {% if item.object_type == 'product' %}
                {% assign product = item %}
                {% assign shipment_text = product.metafields.custom.shipment_text %}
                {% assign shipping_class = 'cf-plp__shipping--regular' %}
                {% if shipment_text contains 'Free' %}
                  {% assign shipping_class = 'cf-plp__shipping--free' %}
                {% elsif shipment_text contains 'Quick' %}
                  {% assign shipping_class = 'cf-plp__shipping--quick' %}
                {% endif %}

                <div class="cf-plp__card"
                     data-vendor="{{ product.vendor | handleize }}"
                     data-type="{{ product.type | handleize }}"
                     data-price="{{ product.price }}"
                     data-available="{{ product.available }}">

                  {% if product.tags contains 'best-seller' or product.tags contains 'featured' %}
                    <span class="cf-plp__card-badge">Best Seller</span>
                  {% elsif product.compare_at_price > product.price %}
                    <span class="cf-plp__card-badge">Sale</span>
                  {% endif %}

                  <a href="{{ product.url }}?variant={{ product.variants.first.id }}" class="cf-plp__card-image-wrap">
                    {% if product.featured_image %}
                      <img src="{{ product.featured_image | image_url: width: 320 }}"
                           alt="{{ product.title }}"
                           class="cf-plp__card-image"
                           loading="lazy">
                    {% else %}
                      <div class="cf-plp__card-image" style="display:flex;align-items:center;justify-content:center;font-size:40px;color:#94a3b8;">üì¶</div>
                    {% endif %}
                    {% if product.variants.size > 1 %}
                      {% comment %} Build variation options list for tooltip {% endcomment %}
                      {% assign variation_list = '' %}
                      {% for option in product.options_with_values %}
                        {% assign opt_values = option.values | join: ', ' %}
                        {% if variation_list == '' %}
                          {% assign variation_list = option.name | append: ': ' | append: opt_values %}
                        {% else %}
                          {% assign variation_list = variation_list | append: ' | ' | append: option.name | append: ': ' | append: opt_values %}
                        {% endif %}
                      {% endfor %}
                      <span class="cf-plp__variants-badge" data-variants="{{ product.variants.size }}">
                        <span class="cf-plp__variants-text">{{ product.variants.size }} Variations</span>
                        <span class="cf-plp__variants-tooltip">{{ variation_list | truncate: 150 }}</span>
                      </span>
                    {% endif %}
                  </a>

                  <div class="cf-plp__card-content">
                    <span class="cf-plp__card-category">{{ product.type | default: 'Product' | truncate: 25 }}</span>

                    <a href="{{ product.url }}?variant={{ product.variants.first.id }}" class="cf-plp__card-title" title="{{ product.title | escape }}">
                      {{ product.title }}
                    </a>

                    {% if product.variants.first.sku %}
                      <div class="cf-plp__card-sku">#{{ product.variants.first.sku }}</div>
                    {% endif %}

                    <div class="cf-plp__price-box">
                      {% comment %} Check if user is logged in and is a member {% endcomment %}
                      {% assign is_logged_in = false %}
                      {% assign is_member = false %}
                      {% if customer %}
                        {% assign is_logged_in = true %}
                        {% for tag in customer.tags %}
                          {% assign tag_lower = tag | downcase %}
                          {% if tag_lower contains 'wholesale' or tag_lower contains 'plus' or tag_lower contains 'member' or tag_lower contains 'cph' or tag_lower contains 'rou' or tag_lower contains 'margin' %}
                            {% assign is_member = true %}
                            {% break %}
                          {% endif %}
                        {% endfor %}
                      {% endif %}

                      {% if is_logged_in and is_member %}
                        {% comment %} Member view - show member price {% endcomment %}
                        {% if product.compare_at_price > product.price %}
                          <div class="cf-plp__price-label">Member Price</div>
                          <div class="cf-plp__price-main">
                            {{ product.price | money }}<span class="cf-plp__price-unit">/Each</span>
                          </div>
                          <div class="cf-plp__price-regular">
                            Was {{ product.compare_at_price | money }}
                          </div>
                        {% else %}
                          <div class="cf-plp__price-label">Member Price</div>
                          <div class="cf-plp__price-main">
                            {{ product.price | money }}<span class="cf-plp__price-unit">/Each</span>
                          </div>
                        {% endif %}
                      {% else %}
                        {% comment %} Non-member view - show RETAIL price (compare_at_price) + vendor-specific CTA {% endcomment %}
                        {% assign retail_price = product.price %}
                        {% if product.compare_at_price > product.price %}
                          {% assign retail_price = product.compare_at_price %}
                        {% endif %}
                        <div class="cf-plp__price-label">Retail Price</div>
                        <div class="cf-plp__price-main">
                          {{ retail_price | money }}<span class="cf-plp__price-unit">/Each</span>
                        </div>
                        {% comment %} Vendor-specific CTAs for non-members {% endcomment %}
                        {% assign vendor_lower = product.vendor | downcase %}
                        {% assign is_own_brand = false %}
                        {% if vendor_lower contains 'celebrate festival' %}
                          {% assign is_own_brand = true %}
                        {% endif %}
                        {% if is_own_brand %}
                          {% comment %} CF Inc products - Show login CTA {% endcomment %}
                          <a href="/account/login?return_url={{ request.path }}{% if request.query_string != blank %}%3F{{ request.query_string | url_param_escape }}{% endif %}" class="cf-plp__login-prompt">
                            üîí Login for member pricing
                          </a>
                        {% else %}
                          {% comment %} Other vendor products - Show call for details CTA (MAP compliance) {% endcomment %}
                          <a href="tel:+14086739999" class="cf-plp__call-prompt">
                            üìû Call for More Details - (408) 673-9999
                          </a>
                        {% endif %}
                      {% endif %}
                    </div>

                    {% if shipment_text != blank %}
                      <div class="cf-plp__shipping {{ shipping_class }}">
                        {% if shipment_text contains 'Free' %}
                          üöö Free Shipping
                        {% elsif shipment_text contains 'Quick' %}
                          ‚ö° Quick Ship
                        {% else %}
                          üì¶ {{ shipment_text | truncate: 20 }}
                        {% endif %}
                      </div>
                    {% endif %}

                    <div class="cf-plp__cart-row">
                      <input type="number" class="cf-plp__qty-input" value="1" min="1" aria-label="Quantity">
                      <button type="button" class="cf-plp__add-btn" data-variant-id="{{ product.variants.first.id }}">
                        Add to Cart
                      </button>
                    </div>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>

          {% comment %} Pagination {% endcomment %}
          {% if paginate.pages > 1 %}
            <div class="cf-plp__pagination">
              {% if paginate.previous %}
                <a href="{{ paginate.previous.url }}" class="cf-plp__page-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                  </svg>
                </a>
              {% endif %}

              {% for part in paginate.parts %}
                {% if part.is_link %}
                  <a href="{{ part.url }}" class="cf-plp__page-num">{{ part.title }}</a>
                {% else %}
                  {% if part.title == paginate.current_page %}
                    <span class="cf-plp__page-num active">{{ part.title }}</span>
                  {% else %}
                    <span class="cf-plp__page-num">{{ part.title }}</span>
                  {% endif %}
                {% endif %}
              {% endfor %}

              {% if paginate.next %}
                <a href="{{ paginate.next.url }}" class="cf-plp__page-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9 18 15 12 9 6"></polyline>
                  </svg>
                </a>
              {% endif %}
            </div>
          {% endif %}

        {% else %}
          <div class="cf-plp__no-results">
            <div class="cf-plp__no-results-icon">üîç</div>
            <h2>No results found for "{{ search.terms }}"</h2>
            <p>Try different keywords or check the spelling</p>
          </div>
        {% endif %}

      </main>
    </div>

    {% endpaginate %}
  {% else %}
    <div class="cf-plp__no-results">
      <div class="cf-plp__no-results-icon">üîç</div>
      <h2>Enter a search term above</h2>
      <p>Search through our catalog of 10,000+ commercial kitchen products</p>
    </div>
  {% endif %}
</div>

{% comment %} Mobile Filter Drawer {% endcomment %}
<div class="cf-plp__mobile-filter-drawer" id="mobile-filter-drawer">
  <div class="cf-plp__mobile-filter-overlay" onclick="closeSearchMobileFilters()"></div>
  <div class="cf-plp__mobile-filter-panel">
    <div class="cf-plp__mobile-filter-header">
      <h3>Filters</h3>
      <button type="button" class="cf-plp__mobile-filter-close" onclick="closeSearchMobileFilters()">√ó</button>
    </div>
    <div class="cf-plp__mobile-filter-content" id="mobile-filter-content">
      <!-- Filters cloned here by JS -->
    </div>
    <div class="cf-plp__mobile-filter-apply">
      <button type="button" onclick="closeSearchMobileFilters()">Apply Filters</button>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Filter State
  const filterState = {
    vendors: [],
    productTypes: [],
    priceRanges: [],
    availability: []
  };

  const productGrid = document.getElementById('product-grid');
  const resultsCount = document.getElementById('filtered-count');
  const activeFiltersContainer = document.getElementById('active-filters');
  const activeFiltersList = document.getElementById('active-filters-list');
  const clearAllBtn = document.getElementById('clear-all-filters');

  // Apply Filters
  function applyFilters() {
    if (!productGrid) return;
    const cards = productGrid.querySelectorAll('.cf-plp__card');
    let visibleCount = 0;

    cards.forEach(card => {
      let visible = true;

      // Vendor filter
      if (filterState.vendors.length > 0) {
        const vendor = card.dataset.vendor;
        if (!filterState.vendors.includes(vendor)) visible = false;
      }

      // Product Type filter
      if (filterState.productTypes.length > 0) {
        const type = card.dataset.type;
        if (!filterState.productTypes.includes(type)) visible = false;
      }

      // Price filter
      if (filterState.priceRanges.length > 0) {
        const price = parseInt(card.dataset.price) / 100;
        let priceMatch = false;
        for (const range of filterState.priceRanges) {
          if (range === '0-500' && price < 500) { priceMatch = true; break; }
          if (range === '500-1000' && price >= 500 && price < 1000) { priceMatch = true; break; }
          if (range === '1000-2500' && price >= 1000 && price < 2500) { priceMatch = true; break; }
          if (range === '2500+' && price >= 2500) { priceMatch = true; break; }
        }
        if (!priceMatch) visible = false;
      }

      // Availability filter
      if (filterState.availability.includes('in-stock')) {
        if (card.dataset.available !== 'true') visible = false;
      }

      card.style.display = visible ? '' : 'none';
      if (visible) visibleCount++;
    });

    if (resultsCount) resultsCount.textContent = visibleCount;
    updateActiveFiltersDisplay();
  }

  // Update Active Filters Display
  function updateActiveFiltersDisplay() {
    const allFilters = [
      ...filterState.vendors.map(v => ({ type: 'vendors', value: v })),
      ...filterState.productTypes.map(t => ({ type: 'productTypes', value: t })),
      ...filterState.priceRanges.map(p => ({ type: 'priceRanges', value: p })),
      ...filterState.availability.map(a => ({ type: 'availability', value: a }))
    ];

    if (allFilters.length > 0 && activeFiltersContainer) {
      activeFiltersContainer.style.display = 'flex';
      if (activeFiltersList) {
        activeFiltersList.innerHTML = allFilters.map(f => `
          <span class="cf-plp__filter-chip">
            ${f.value.replace(/-/g, ' ')}
            <button type="button" class="cf-plp__filter-chip-remove" onclick="removeSearchFilter('${f.type}', '${f.value}')">√ó</button>
          </span>
        `).join('');
      }
    } else if (activeFiltersContainer) {
      activeFiltersContainer.style.display = 'none';
    }
  }

  // Remove Filter
  window.removeSearchFilter = function(type, value) {
    filterState[type] = filterState[type].filter(v => v !== value);
    const checkbox = document.querySelector(`input[name="${type === 'vendors' ? 'vendor' : type === 'productTypes' ? 'product-type' : type === 'priceRanges' ? 'price' : 'availability'}"][value="${value}"]`);
    if (checkbox) checkbox.checked = false;
    applyFilters();
  };

  // Clear All Filters
  if (clearAllBtn) {
    clearAllBtn.addEventListener('click', function() {
      filterState.vendors = [];
      filterState.productTypes = [];
      filterState.priceRanges = [];
      filterState.availability = [];
      document.querySelectorAll('.cf-plp__filter-option input[type="checkbox"]').forEach(cb => cb.checked = false);
      applyFilters();
    });
  }

  // Checkbox Event Listeners
  document.querySelectorAll('input[name="vendor"]').forEach(cb => {
    cb.addEventListener('change', function() {
      if (this.checked) filterState.vendors.push(this.value);
      else filterState.vendors = filterState.vendors.filter(v => v !== this.value);
      applyFilters();
    });
  });

  document.querySelectorAll('input[name="product-type"]').forEach(cb => {
    cb.addEventListener('change', function() {
      if (this.checked) filterState.productTypes.push(this.value);
      else filterState.productTypes = filterState.productTypes.filter(t => t !== this.value);
      applyFilters();
    });
  });

  document.querySelectorAll('input[name="price"]').forEach(cb => {
    cb.addEventListener('change', function() {
      if (this.checked) filterState.priceRanges.push(this.value);
      else filterState.priceRanges = filterState.priceRanges.filter(p => p !== this.value);
      applyFilters();
    });
  });

  document.querySelectorAll('input[name="availability"]').forEach(cb => {
    cb.addEventListener('change', function() {
      if (this.checked) filterState.availability.push(this.value);
      else filterState.availability = filterState.availability.filter(a => a !== this.value);
      applyFilters();
    });
  });

  // View Toggle
  document.querySelectorAll('.cf-plp__view-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      document.querySelectorAll('.cf-plp__view-btn').forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      if (productGrid) {
        if (this.dataset.view === 'list') {
          productGrid.classList.add('list-view');
        } else {
          productGrid.classList.remove('list-view');
        }
      }
    });
  });

  // Add to Cart
  document.querySelectorAll('.cf-plp__add-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      const variantId = this.dataset.variantId;
      const card = this.closest('.cf-plp__card');
      const qty = card ? parseInt(card.querySelector('.cf-plp__qty-input').value) || 1 : 1;
      const button = this;

      button.disabled = true;
      button.textContent = 'Adding...';

      fetch('/cart/add.js', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ id: parseInt(variantId), quantity: qty })
      })
      .then(res => {
        if (!res.ok) throw new Error('Add to cart failed');
        return res.json();
      })
      .then(data => {
        button.textContent = 'Added!';
        button.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';

        // Update cart count in header
        if (window.updateCartCount) window.updateCartCount();
        else {
          fetch('/cart.js').then(r => r.json()).then(cart => {
            const countEls = document.querySelectorAll('.cart-count-bubble span, .cart-count, [data-cart-count]');
            countEls.forEach(el => el.textContent = cart.item_count);
          });
        }

        // Show toast notification
        if (typeof window.cfShowCartToast === 'function') {
          window.cfShowCartToast(data, qty);
        }

        setTimeout(() => {
          button.textContent = 'Add to Cart';
          button.style.background = '';
          button.disabled = false;
        }, 2000);
      })
      .catch(err => {
        console.error('Cart error:', err);
        button.textContent = 'Error';
        button.style.background = '#ef4444';
        setTimeout(() => {
          button.textContent = 'Add to Cart';
          button.style.background = '';
          button.disabled = false;
        }, 2000);
      });
    });
  });

  // Mobile Filter Button
  const mobileFilterBtn = document.getElementById('mobile-filter-btn');
  if (mobileFilterBtn) {
    mobileFilterBtn.addEventListener('click', openSearchMobileFilters);
  }
});

// Sort Handler
window.handleSearchSort = function(value) {
  const url = new URL(window.location);
  url.searchParams.set('sort_by', value);
  window.location = url;
};

// Mobile Filters
function openSearchMobileFilters() {
  const drawer = document.getElementById('mobile-filter-drawer');
  const content = document.getElementById('mobile-filter-content');
  const sidebar = document.querySelector('.cf-plp__sidebar');

  if (content && sidebar && content.children.length === 0) {
    content.innerHTML = sidebar.innerHTML;

    // Sync checkbox states
    content.querySelectorAll('input[type="checkbox"]').forEach(cb => {
      const original = sidebar.querySelector(`input[name="${cb.name}"][value="${cb.value}"]`);
      if (original) cb.checked = original.checked;

      cb.addEventListener('change', function() {
        const orig = sidebar.querySelector(`input[name="${this.name}"][value="${this.value}"]`);
        if (orig) {
          orig.checked = this.checked;
          orig.dispatchEvent(new Event('change'));
        }
      });
    });
  }

  if (drawer) {
    drawer.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
}

function closeSearchMobileFilters() {
  const drawer = document.getElementById('mobile-filter-drawer');
  if (drawer) {
    drawer.classList.remove('active');
    document.body.style.overflow = '';
  }
}
</script>

{% schema %}
{
  "name": "CF Search Results",
  "tag": "section",
  "class": "section-search-cf",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "min": 12,
      "max": 48,
      "step": 12,
      "default": 24,
      "label": "Products per page"
    },
    {
      "type": "checkbox",
      "id": "compact_mode",
      "label": "Compact Mode (5 columns)",
      "default": true,
      "info": "Show 5 products per row with smaller cards"
    }
  ],
  "presets": [
    {
      "name": "CF Search Results"
    }
  ]
}
{% endschema %}
