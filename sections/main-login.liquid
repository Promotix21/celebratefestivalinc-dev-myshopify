{{ 'customer.css' | asset_url | stylesheet_tag }}
{{ 'customer-accounts.css' | asset_url | stylesheet_tag }}

<div class="cf-auth-split">
  <!-- Left Side - Benefits -->
  <div class="cf-auth-benefits">
    <div class="cf-benefits-content">
      <div class="cf-benefits-logo">
        <a href="{{ routes.root_url }}">
          {%- if settings.logo != blank -%}
            <img src="{{ settings.logo | image_url: width: 180 }}" alt="{{ shop.name }}">
          {%- else -%}
            <img src="https://celebratefestivalinc.com/cdn/shop/files/celebrate-logo.png" alt="{{ shop.name }}">
          {%- endif -%}
        </a>
      </div>

      <h2 class="cf-benefits-title">Member Benefits</h2>

      <div class="cf-benefits-list">
        <div class="cf-benefit-item">
          <div class="cf-benefit-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
            </svg>
          </div>
          <div class="cf-benefit-text">
            <strong>Exclusive Member Pricing</strong>
            <span>Save up to 15% on all orders</span>
          </div>
        </div>

        <div class="cf-benefit-item">
          <div class="cf-benefit-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="1" y="3" width="22" height="18" rx="2" ry="2"></rect>
              <line x1="1" y1="9" x2="23" y2="9"></line>
            </svg>
          </div>
          <div class="cf-benefit-text">
            <strong>Easy Order Tracking</strong>
            <span>Track all your orders in one place</span>
          </div>
        </div>

        <div class="cf-benefit-item">
          <div class="cf-benefit-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
              <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
              <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
          </div>
          <div class="cf-benefit-text">
            <strong>Free Shipping</strong>
            <span>On qualifying orders over $500</span>
          </div>
        </div>

        <div class="cf-benefit-item">
          <div class="cf-benefit-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
          </div>
          <div class="cf-benefit-text">
            <strong>Priority Support</strong>
            <span>Dedicated customer service team</span>
          </div>
        </div>
      </div>

      <div class="cf-benefits-footer">
        <p>Trusted by 10,000+ restaurant professionals</p>
      </div>
    </div>
  </div>

  <!-- Right Side - Form -->
  <div class="cf-auth-form-side">
    <div class="cf-auth-form-container">
      {%- if recover_password -%}
        <!-- Forgot Password Form -->
        <h1 class="cf-auth-title" id="recover" tabindex="-1">{{ 'customer.recover_password.title' | t }}</h1>
        <p class="cf-auth-subtitle">{{ 'customer.recover_password.subtext' | t }}</p>

        {%- form 'recover_customer_password' -%}
          {% assign recover_success = form.posted_successfully? %}

          {%- if form.errors -%}
            <div class="cf-alert cf-alert-error">
              <span class="cf-alert-icon">!</span>
              <span>{{ form.errors.messages.form }}</span>
            </div>
          {%- endif -%}

          <div class="cf-form-group">
            <label class="cf-form-label" for="RecoverEmail">
              {{ 'customer.login_page.email' | t }} <span class="required">*</span>
            </label>
            <input
              type="email"
              class="cf-form-input"
              value=""
              name="email"
              id="RecoverEmail"
              autocorrect="off"
              autocapitalize="off"
              autocomplete="email"
              {% if form.errors %}
                aria-invalid="true"
                aria-describedby="RecoverEmail-email-error"
              {% endif %}
              placeholder="Enter your email address"
            >
          </div>

          <button type="submit" class="cf-btn cf-btn-primary">
            {{ 'customer.login_page.submit' | t }}
          </button>
        {%- endform -%}

        <div class="cf-auth-footer">
          Remember your password? <a href="{{ routes.account_login_url }}">Back to Sign In</a>
        </div>
      {%- else -%}
        <!-- Login Form -->
        <h1 class="cf-auth-title" id="login" tabindex="-1">Welcome Back</h1>
        <p class="cf-auth-subtitle">Sign in to access your account and member pricing</p>

        {%- assign recover_success = false -%}
        {%- if request.path contains 'account/login' and form.posted_successfully? -%}
          {%- assign recover_success = true -%}
        {%- endif -%}

        {%- if recover_success == true -%}
          <div class="cf-alert cf-alert-success">
            <span class="cf-alert-icon">âœ“</span>
            <span>{{ 'customer.recover_password.success' | t }}</span>
          </div>
        {%- endif -%}

        {%- form 'customer_login', novalidate: 'novalidate' -%}
          {%- comment %} Capture return_url from query string to redirect back after login {% endcomment -%}
          {%- assign return_url = request.path -%}
          {%- if request.query_string contains 'return_url=' -%}
            {%- assign return_url_parts = request.query_string | split: 'return_url=' -%}
            {%- if return_url_parts.size > 1 -%}
              {%- assign return_url = return_url_parts[1] | split: '&' | first | url_decode -%}
            {%- endif -%}
          {%- endif -%}
          <input type="hidden" name="checkout_url" value="{{ return_url }}">

          {%- if form.errors -%}
            <div class="cf-alert cf-alert-error">
              <span class="cf-alert-icon">!</span>
              <span>{{ form.errors | default_errors }}</span>
            </div>
          {%- endif -%}

          <div class="cf-form-group">
            <label class="cf-form-label" for="CustomerEmail">
              Email Address <span class="required">*</span>
            </label>
            <input
              type="email"
              class="cf-form-input"
              name="customer[email]"
              id="CustomerEmail"
              autocomplete="email"
              autocorrect="off"
              autocapitalize="off"
              {% if form.errors contains 'form' %}
                aria-invalid="true"
              {% endif %}
              placeholder="you@company.com"
            >
          </div>

          {%- if form.password_needed -%}
            <div class="cf-form-group">
              <label class="cf-form-label" for="CustomerPassword">
                Password <span class="required">*</span>
              </label>
              <input
                type="password"
                class="cf-form-input"
                value=""
                name="customer[password]"
                id="CustomerPassword"
                autocomplete="current-password"
                {% if form.errors contains 'form' %}
                  aria-invalid="true"
                {% endif %}
                placeholder="Enter your password"
              >
            </div>

            <div class="cf-form-options">
              <label class="cf-checkbox-label">
                <input type="checkbox" name="remember"> Remember me
              </label>
              <a href="{{ routes.account_login_url }}#recover" class="cf-forgot-link">
                Forgot password?
              </a>
            </div>
          {%- endif -%}

          <button type="submit" class="cf-btn cf-btn-primary">
            Sign In
          </button>
        {%- endform -%}

        <div class="cf-auth-divider">
          <span>New to Celebrate Festival?</span>
        </div>

        <a href="{{ routes.account_register_url }}{% if return_url != blank %}?return_url={{ return_url | url_param_escape }}{% endif %}" class="cf-btn cf-btn-outline">
          Create an Account
        </a>
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "t:sections.main-login.name",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 0
    }
  ]
}
{% endschema %}
